<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>XYLENT V3 MOBILE</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=SF+Pro+Display:wght@300;400;600&family=Fira+Code:wght@300;400&display=swap');

        :root {
            --ios-bg: #000000;
            --accent: #00ff41;
            --glass: rgba(28, 28, 30, 0.7);
        }

        body {
            background-color: var(--ios-bg);
            color: white;
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, sans-serif;
            overflow: hidden;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Glassmorphism Header */
        .glass-header {
            background: var(--glass);
            backdrop-filter: blur(25px) saturate(180%);
            -webkit-backdrop-filter: blur(25px) saturate(180%);
            border-bottom: 0.5px solid rgba(255, 255, 255, 0.1);
            padding-top: env(safe-area-inset-top, 40px);
        }

        /* Chat Bubbles Style */
        .message-bubble {
            max-width: 85%;
            border-radius: 20px;
            padding: 12px 16px;
            font-size: 15px;
            line-height: 1.4;
            position: relative;
            animation: bubbleAppear 0.4s cubic-bezier(0.15, 0, 0.2, 1) forwards;
        }

        @keyframes bubbleAppear {
            from { opacity: 0; transform: translateY(20px) scale(0.9); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }

        .user-bubble {
            background: #0A84FF; /* iOS Blue */
            color: white;
            align-self: flex-end;
            border-bottom-right-radius: 4px;
        }

        .ai-bubble {
            background: #1C1C1E;
            border: 0.5px solid rgba(0, 255, 65, 0.2);
            align-self: flex-start;
            border-bottom-left-radius: 4px;
            font-family: 'Fira Code', monospace;
            color: var(--accent);
            box-shadow: 0 4px 15px rgba(0, 255, 65, 0.05);
        }

        /* Input Area Style */
        .input-area {
            background: var(--glass);
            backdrop-filter: blur(25px);
            -webkit-backdrop-filter: blur(25px);
            border-top: 0.5px solid rgba(255, 255, 255, 0.1);
            padding-bottom: env(safe-area-inset-bottom, 20px);
        }

        input {
            background: #2C2C2E;
            border-radius: 22px;
            padding: 10px 18px;
            color: white;
            border: none;
            outline: none;
            font-size: 16px; /* Mencegah auto-zoom di iOS */
        }

        /* Typing Animation */
        .dot {
            width: 5px; height: 5px; background: var(--accent);
            border-radius: 50%; display: inline-block;
            animation: wave 1.3s infinite;
        }
        .dot:nth-child(2) { animation-delay: -1.1s; }
        .dot:nth-child(3) { animation-delay: -0.9s; }

        @keyframes wave {
            0%, 60%, 100% { transform: translateY(0); opacity: 0.3; }
            30% { transform: translateY(-4px); opacity: 1; }
        }

        #chat-flow::-webkit-scrollbar { width: 0px; }
    </style>
</head>
<body>

    <header class="glass-header px-6 pb-4 flex justify-between items-center sticky top-0 z-50">
        <div>
            <h1 class="text-xl font-bold tracking-tight">XYLENT <span class="text-[#00ff41]">V3</span></h1>
            <div class="flex items-center gap-1.5">
                <span class="w-1.5 h-1.5 rounded-full bg-[#00ff41] animate-pulse"></span>
                <p class="text-[10px] opacity-50 uppercase font-semibold tracking-widest">Secure Link Active</p>
            </div>
        </div>
        <div class="h-10 w-10 rounded-2xl bg-white/5 flex items-center justify-center border border-white/10">
            <i data-lucide="cpu" class="text-[#00ff41] w-5 h-5"></i>
        </div>
    </header>

    <main id="chat-flow" class="flex-grow overflow-y-auto px-4 py-6 flex flex-col gap-5">
        <div class="ai-bubble message-bubble">
            <span class="opacity-50 text-[10px] block mb-1">SYSTEM_CORE</span>
            Kernel Debugging mode initialized.<br>
            Connected to: nekografcode.vercel.app<br>
            Awaiting instructions...
        </div>
    </main>

    <footer class="input-area px-4 pt-4 pb-8">
        <div class="max-w-4xl mx-auto flex items-center gap-3">
            <div class="relative flex-grow">
                <input type="text" id="userInput" class="w-full" placeholder="Ketik perintah audit..." autocomplete="off">
            </div>
            <button id="sendBtn" class="h-11 w-11 bg-[#00ff41] rounded-full flex items-center justify-center active:scale-90 transition-all shadow-[0_0_15px_rgba(0,255,65,0.4)]">
                <i data-lucide="arrow-up" class="text-black w-6 h-6 stroke-[3px]"></i>
            </button>
        </div>
    </footer>

    <script>
        // Init Lucide Icons
        lucide.createIcons();

        const chatFlow = document.getElementById('chat-flow');
        const userInput = document.getElementById('userInput');
        const sendBtn = document.getElementById('sendBtn');

        async function processChat() {
            const text = userInput.value.trim();
            if (!text) return;

            // 1. Tambah bubble User
            createBubble(text, 'user');
            userInput.value = '';

            // 2. Tambah bubble Loading AI
            const loadingId = 'ai-' + Date.now();
            const loadingContent = `
                <div class="flex items-center gap-1 py-1">
                    <div class="dot"></div><div class="dot"></div><div class="dot"></div>
                </div>
            `;
            createBubble(loadingContent, 'ai', loadingId);
            scrollToBottom();

            try {
                // 3. Ambil data dari API Nekografcode
                const response = await fetch('https://nekografcode.vercel.app/api/wormgpt.js', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ text: text })
                });

                const data = await response.text();
                
                // 4. Update bubble AI dengan hasil asli
                const aiElement = document.getElementById(loadingId);
                if (aiElement) {
                    aiElement.innerHTML = `
                        <span class="opacity-50 text-[10px] block mb-1">XYLENT_DECRYPTED</span>
                        ${data.replace(/\n/g, '<br>')}
                    `;
                }

            } catch (err) {
                const aiElement = document.getElementById(loadingId);
                if (aiElement) {
                    aiElement.innerHTML = `<span class="text-red-500 font-bold">[!] ERROR: Connection Refused</span>`;
                }
            }
            scrollToBottom();
        }

        function createBubble(content, type, id = null) {
            const div = document.createElement('div');
            div.className = `message-bubble ${type === 'user' ? 'user-bubble' : 'ai-bubble'}`;
            if (id) div.id = id;
            div.innerHTML = content;
            chatFlow.appendChild(div);
        }

        function scrollToBottom() {
            chatFlow.scrollTo({
                top: chatFlow.scrollHeight,
                behavior: 'smooth'
            });
        }

        sendBtn.addEventListener('click', processChat);
        userInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') processChat();
        });

        // Haptic Feedback simulasi untuk mobile
        sendBtn.addEventListener('touchstart', () => {
            if (window.navigator.vibrate) window.navigator.vibrate(10);
        });
    </script>
</body>
</html>
